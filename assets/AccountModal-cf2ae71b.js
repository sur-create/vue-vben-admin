var B=Object.defineProperty,k=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var h=(t,o,e)=>o in t?B(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,m=(t,o)=>{for(var e in o||(o={}))$.call(o,e)&&h(t,e,o[e]);if(g)for(var e of g(o))v.call(o,e)&&h(t,e,o[e]);return t},b=(t,o)=>k(t,S(o));var f=(t,o,e)=>new Promise((a,n)=>{var c=r=>{try{i(e.next(r))}catch(d){n(d)}},s=r=>{try{i(e.throw(r))}catch(d){n(d)}},i=r=>r.done?a(r.value):Promise.resolve(r.value).then(c,s);i((e=e.apply(t,o)).next())});import{B as A,a as y}from"./index-04dbccd5.js";import{B as x}from"./BasicForm-8ff45fc7.js";import"./componentMap-9be5d326.js";import{u as q}from"./useForm-e6560703.js";import"./RadioButtonGroup-f37554dc.js";import{_ as C}from"./index.js";import"./uuid-a2a47690.js";import{i as R,b as T,a as L}from"./system-82075152.js";import{d as O,f as w,c as D,u as p,a7 as I,Z as N,a8 as U,a9 as V,l as j,ac as E}from"./vue-ea98dac5.js";const z=(()=>{const t=["华东分部","华南分部","西北分部"],o=["研发部","市场部","商务部","财务部"];return t.reduce((e,a,n)=>(e[n]=a,o.forEach((c,s)=>e[`${n}-${s}`]=`${a}-${c}`),e),{})})(),re=[{title:"用户名",dataIndex:"account",width:120},{title:"昵称",dataIndex:"nickname",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"角色",dataIndex:"role",width:200},{title:"所属部门",dataIndex:"dept",customRender:({value:t})=>z[t]},{title:"备注",dataIndex:"remark"}],se=[{field:"account",label:"用户名",component:"Input",colProps:{span:8}},{field:"nickname",label:"昵称",component:"Input",colProps:{span:8}}],G=[{field:"account",label:"用户名",component:"Input",helpMessage:["本字段演示异步验证","不能输入带有admin的用户名"],rules:[{required:!0,message:"请输入用户名"},{trigger:"blur",validator(t,o){return new Promise((e,a)=>{if(!o)return e();R(o).then(e).catch(n=>{a(n.message||"验证失败")})})}}]},{field:"pwd",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"role",component:"ApiSelect",componentProps:{api:T,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"所属部门",component:"TreeSelect",componentProps:{fieldNames:{label:"deptName",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"昵称",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}],W=O({name:"AccountModal",components:{BasicModal:A,BasicForm:x},emits:["success","register"],setup(t,{emit:o}){const e=w(!0),a=w(""),[n,{setFieldsValue:c,updateSchema:s,resetFields:i,validate:r}]=q({labelWidth:100,baseColProps:{span:24},schemas:G,showActionButtonGroup:!1,actionColOptions:{span:23}}),[d,{setModalProps:u,closeModal:_}]=y(l=>f(this,null,function*(){i(),u({confirmLoading:!1}),e.value=!!(l!=null&&l.isUpdate),p(e)&&(a.value=l.record.id,c(m({},l.record)));const P=yield L();s([{field:"pwd",show:!p(e)},{field:"dept",componentProps:{treeData:P}}])})),M=D(()=>p(e)?"编辑账号":"新增账号");function F(){return f(this,null,function*(){try{const l=yield r();u({confirmLoading:!0}),_(),o("success",{isUpdate:p(e),values:b(m({},l),{id:a.value})})}finally{u({confirmLoading:!1})}})}return{registerModal:d,registerForm:n,getTitle:M,handleSubmit:F}}});function Z(t,o,e,a,n,c){const s=I("BasicForm"),i=I("BasicModal");return N(),U(i,E(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:V(()=>[j(s,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const H=C(W,[["render",Z]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{H as A,ie as a,re as c,se as s};
