import{aW as v,aX as b,aY as _,U as g,C as I}from"./index.js";import{u as a,s as M,f as R,g as E,j as $,d as A,b as B,a7 as U,Z as S,a8 as z,a9 as m,l as d,E as p}from"./vue-ea98dac5.js";import{P as L}from"./index-b777c0c9.js";import"./antd-4273b3e7.js";import"./useContentViewHeight-b8e9ee08.js";import"./useWindowSizeFn-997fa1d0.js";import"./onMountedOrActivated-3eb95ecd.js";const N="watermark-dom",f=new Map;function y(i=R(document.body)){const o=Symbol(N);if(a(i)&&f.has(o)){const{setWatermark:t,clear:e}=f.get(o);return{setWatermark:t,clear:e,clearAll:x}}const u=_(function(){const t=a(i);if(!t)return;const{clientHeight:e,clientWidth:l}=t;r({height:e,width:l})}),c=M(),k=()=>{const t=a(c);c.value=void 0;const e=a(i);f.delete(o),e&&(t&&e.removeChild(t),v(e,u))};function s(t){const e=document.createElement("canvas"),l=300,W=240;Object.assign(e,{width:l,height:W});const n=e.getContext("2d");return n&&(n.rotate(-20*Math.PI/120),n.font="15px Vedana",n.fillStyle="rgba(0, 0, 0, 0.15)",n.textAlign="left",n.textBaseline="middle",n.fillText(t,l/20,W)),e.toDataURL("image/png")}function r(t={}){const e=a(c);e&&(g(t.width)&&(e.style.width=`${t.width}px`),g(t.height)&&(e.style.height=`${t.height}px`),g(t.str)&&(e.style.background=`url(${s(t.str)}) left top repeat`))}const h=t=>{if(a(c)&&f.has(o)){r({str:t});return}const e=document.createElement("div");c.value=e,e.style.pointerEvents="none",e.style.top="0px",e.style.left="0px",e.style.position="absolute",e.style.zIndex="100000";const l=a(i);if(!l)return;const{clientHeight:W,clientWidth:n}=l;r({str:t,width:n,height:W}),l.appendChild(e),f.set(o,{setWatermark:w,clear:k})};function w(t){h(t),b(document.documentElement,u),E()&&$(()=>{k()})}return{setWatermark:w,clear:k,clearAll:x}}function x(){Array.from(f.values()).forEach(i=>{i.clear()})}const O=A({__name:"index",setup(i){const{setWatermark:o,clear:C,clearAll:u}=y(),{setWatermark:c}=y();return B(()=>{u()}),(k,s)=>{const r=U("a-button");return S(),z(a(L),{title:"水印示例"},{default:m(()=>[d(a(I),{class:"w-full h-32 bg-white rounded-md",title:"Global WaterMark"},{default:m(()=>[d(r,{type:"primary",class:"mr-2",onClick:s[0]||(s[0]=h=>a(o)("WaterMark Info1"))},{default:m(()=>[p(" Create Watermark1 ")]),_:1}),d(r,{type:"primary",class:"mr-2",onClick:s[1]||(s[1]=h=>a(c)("WaterMark Info2"))},{default:m(()=>[p(" Create Watermark2 ")]),_:1}),d(r,{color:"error",class:"mr-2",onClick:a(C)},{default:m(()=>[p(" Clear Watermark1 ")]),_:1},8,["onClick"]),d(r,{color:"error",class:"mr-2",onClick:a(u)},{default:m(()=>[p(" ClearAll ")]),_:1},8,["onClick"]),d(r,{color:"warning",class:"mr-2",onClick:s[2]||(s[2]=h=>a(o)("WaterMark Info New"))},{default:m(()=>[p(" Update Watermark1 ")]),_:1})]),_:1})]),_:1})}}});export{O as default};
